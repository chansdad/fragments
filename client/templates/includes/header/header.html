<template name="header">
  <header id="header" class="{{#if collection}}with-collection{{/if}} {{#if theme}}theme-{{theme.theme}}{{/if}}" style="{{#if collection}}background-color:{{collection.color}}{{/if}}">
    <div class="row flex">
      <div class="left-section title-bar">
        {{#if currentUser}}
          <a href="#" class="nav-toggle {{#if hasBackArrow}}open{{/if}}" data-nav-toggle><span></span></a>
        {{/if}}
        <h1>
          {{#if collection}}
            <a href={{pathFor route='collection' data=collection}}>{{collection.name}}
              {{#if collectionOwner}}by {{collectionOwner.name}}{{/if}}
            </a>
            {{#unless collection.is_public}}
              {{> iconLockOn}}
            {{/unless}}
          {{else}}
            <a href="/">Fragments</a>
          {{/if}}
        </h1>
      </div>
      <div class="middle-section">
        {{#if hasSearchBar}}
          {{> headerSearchBar}}
        {{/if}}
      </div>
      <div class="right-section">
        <div>
          <div class="display-toggle">
            <a href="#" class="{{#unless isListView}}active{{/unless}}" data-mode="grid">Grid</a>
            <a href="#" class="{{#if isListView}}active{{/if}}" data-mode="list">List</a>
          </div>
          <div class="spacer"></div>
          {{#if currentUser}}
            <div class="notifications">
              <a href="#" data-toggle-notifications class="handle {{#if unreadNotificationsCount}}unread{{/if}}">
                {{#if unreadNotificationsCount}}
                <span>{{unreadNotificationsCount}}</span>
                {{else}}
                  <i class="fa fa-bell-o"></i>
                {{/if}}
              </a>
            </div>
            <div class="user">
              <a href="#" data-toggle-tooltip class="handle" alt="{{currentUser.profile.name}}" style="background-image: url({{currentUser.profile.picture}})"></a>
              {{#if userTooltipIsOpen}}
                {{> headerUserTooltip}}
              {{/if}}
            </div>
          {{else}}
            <div class="buttons">
              <a href="/login" class="button">Log in</a>
            </div>
          {{/if}}
        </div>
      </div>
    </div>
  </header>
</template>